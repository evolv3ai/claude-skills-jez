{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "KASM Workspaces Installation Parameters",
  "description": "Required and optional parameters for KASM installation. Gather ALL required parameters before starting installation.",
  "type": "object",
  "required": [
    "kasm_server_ip",
    "kasm_admin_password"
  ],
  "properties": {
    "kasm_server_ip": {
      "type": "string",
      "description": "Target server IP address for KASM deployment",
      "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
    },
    "ssh_user": {
      "type": "string",
      "description": "SSH username for server access",
      "default": "ubuntu"
    },
    "ssh_key_path": {
      "type": "string",
      "description": "Path to SSH private key for server access",
      "default": "~/.ssh/id_rsa"
    },
    "kasm_admin_password": {
      "type": "string",
      "description": "KASM admin password (minimum 12 characters)",
      "minLength": 12,
      "sensitive": true
    },
    "kasm_admin_email": {
      "type": "string",
      "description": "KASM admin email address",
      "default": "admin@kasm.local",
      "format": "email"
    },
    "swap_size_gb": {
      "type": "integer",
      "description": "Swap file size in GB (recommended 8GB for ARM64)",
      "default": 8,
      "minimum": 0,
      "maximum": 32
    },
    "kasm_port": {
      "type": "integer",
      "description": "KASM web UI port (default 443 after install)",
      "default": 443
    },
    "use_cloudflare_tunnel": {
      "type": "boolean",
      "description": "Whether to configure Cloudflare Tunnel for HTTPS access",
      "default": false
    },
    "cloudflare_api_token": {
      "type": "string",
      "description": "Cloudflare API token with Tunnel and DNS permissions (required if use_cloudflare_tunnel is true)",
      "sensitive": true
    },
    "cloudflare_account_id": {
      "type": "string",
      "description": "Cloudflare account ID (required if use_cloudflare_tunnel is true)"
    },
    "tunnel_hostname": {
      "type": "string",
      "description": "Hostname for Cloudflare tunnel (e.g., kasm.yourdomain.com)",
      "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-_.]+\\.[a-zA-Z]{2,}$"
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "use_cloudflare_tunnel": { "const": true }
        }
      },
      "then": {
        "required": ["cloudflare_api_token", "cloudflare_account_id", "tunnel_hostname"]
      }
    }
  ]
}
