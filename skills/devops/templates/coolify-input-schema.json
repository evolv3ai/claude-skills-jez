{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Coolify Installation Parameters",
  "description": "Required and optional parameters for Coolify installation. Gather ALL required parameters before starting installation.",
  "type": "object",
  "required": [
    "coolify_server_ip",
    "coolify_root_user_email",
    "coolify_root_user_password",
    "coolify_instance_domain",
    "coolify_wildcard_domain"
  ],
  "properties": {
    "coolify_server_ip": {
      "type": "string",
      "description": "Target server IP address for Coolify installation",
      "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"
    },
    "ssh_user": {
      "type": "string",
      "description": "SSH username for server access",
      "default": "ubuntu"
    },
    "ssh_key_path": {
      "type": "string",
      "description": "Path to SSH private key for server access",
      "default": "~/.ssh/id_rsa"
    },
    "coolify_root_user_email": {
      "type": "string",
      "description": "Admin email address for Coolify login",
      "format": "email"
    },
    "coolify_root_user_password": {
      "type": "string",
      "description": "Admin password (min 8 chars, must include: uppercase, lowercase, number, symbol)",
      "minLength": 8,
      "sensitive": true
    },
    "coolify_instance_domain": {
      "type": "string",
      "description": "Main Coolify URL (e.g., coolify.example.com)",
      "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-_.]+\\.[a-zA-Z]{2,}$"
    },
    "coolify_wildcard_domain": {
      "type": "string",
      "description": "Base domain for deployed apps (e.g., example.com)",
      "pattern": "^[a-zA-Z0-9][a-zA-Z0-9-_.]+\\.[a-zA-Z]{2,}$"
    },
    "use_cloudflare_tunnel": {
      "type": "boolean",
      "description": "Whether to configure Cloudflare Tunnel for HTTPS access",
      "default": true
    },
    "cloudflare_api_token": {
      "type": "string",
      "description": "Cloudflare API token with Tunnel and DNS permissions (required if use_cloudflare_tunnel is true)",
      "sensitive": true
    },
    "cloudflare_account_id": {
      "type": "string",
      "description": "Cloudflare account ID (required if use_cloudflare_tunnel is true)"
    },
    "cloudflare_zone_id": {
      "type": "string",
      "description": "Cloudflare zone ID (optional, can be auto-detected from domain)"
    },
    "tunnel_name": {
      "type": "string",
      "description": "Name for the Cloudflare tunnel",
      "default": "coolify-tunnel"
    },
    "use_origin_certificates": {
      "type": "boolean",
      "description": "Whether to configure Cloudflare origin certificates (required for OAuth callbacks and webhooks)",
      "default": false
    },
    "additional_ssh_pubkeys": {
      "type": "array",
      "description": "Additional SSH public keys to add to authorized_keys",
      "items": {
        "type": "string"
      }
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "use_cloudflare_tunnel": { "const": true }
        }
      },
      "then": {
        "required": ["cloudflare_api_token", "cloudflare_account_id"]
      }
    }
  ]
}
